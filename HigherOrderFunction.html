<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Higher Order Function</title>
</head>
<body>
    <h1>Higher Order Function</h1>
    <script>
        // Overview and example: là một function mà nhận vào tham số là 1 function hoặc return về 1 function
        const TinhTong = a => b => a + b // return về arrow function khác
        const KetQua = [1, 2, 3].map((item) => item * item)
        console.log(TinhTong(1)(3))
        console.log(KetQua)

        // 1. Callback function
        const num = [1, 2, 3]
        num.forEach((item, index) => {
            console.log('Vị trí', index, ' là', item)
        });
        // hoặc
        const callback = (item, index) => {
            console.log(`Vị trí ${index} là ${item}`)
        }
        num.forEach(callback)

        // 2. Closure: kỹ thuật lưu lại giá trị của biến cục bộ trong một function
        const increase = () => {
            let x = 0
            const increaseInner = () => ++x
            return increaseInner
        }
        const myFunc = increase()
        console.log(increase()()) // 1
        console.log(increase()()) // 1
        console.log(myFunc()) // 1
        console.log(myFunc()) // 2
        console.log(myFunc()) // 3

        /*
            3. Currying: kỹ thuật mà cho phép chuyển đổi một function nhiều tham số thành
            những function liên tiếp có một tham số
        */
        /*
            Giải 3 bài toán để áp dụng callback và currying
            - Hãy tìm các số tự nhiên bé hơn 10 và là số lẻ
            - Hãy tìm các số tự nhiên bé hơn 20 và là số chẵn
            - Hãy tìm các số tự nhiên bé hơn 30 và là số nếu chia 3 thì dư 2
        */
        // Cách 1: Dùng callback
        const findNumber = (num, func) => {
            const result = []
            for(let i = 0; i < num; i++) {
                if(func(i)) {
                    result.push(i)
                }
            }
            return result
        }
        let a = findNumber(10, (number) => number % 2 === 1)
        let b = findNumber(20, (number) => number % 2 === 0)
        let c = findNumber(30, (number) => number % 3 === 2)
        console.log(a)
        console.log(b)
        console.log(c)

        // Cách 2: Dùng currying (thường được dùng trong React)
        const findNumberCurrying = (num) => (func) => {
            const result = []
            for(i = 0; i < num; i++) {
                if(func(i)) {
                    result.push(i)
                }
            }
            return result
        }
        let d = findNumberCurrying(10)((number) => number % 2 === 1)
        let e = findNumberCurrying(20)((number) => number % 2 === 0)
        let f = findNumberCurrying(30)((number) => number % 3 === 2)
        console.log(d)
        console.log(e)
        console.log(f)
    </script>
</body>
</html>